================================================================================
  ğŸ” COMO DEBUGAR UMA CONVERSA ESPECÃFICA - GUIA RÃPIDO
================================================================================

ğŸ“‹ PROBLEMA ENCONTRADO:
"Conversa atribuÃ­da de Gustavo para Gustavo" vÃ¡rias vezes

ğŸ¯ SOLUÃ‡ÃƒO: Use as ferramentas de debug criadas!

================================================================================
  MÃ‰TODO 1: Script PHP (MAIS COMPLETO) â­ RECOMENDADO
================================================================================

1. Abra o terminal na pasta do projeto
2. Execute:

   php debug-conversation.php [ID_DA_CONVERSA]

   Exemplo:
   php debug-conversation.php 123

3. O script vai mostrar:
   âœ… InformaÃ§Ãµes bÃ¡sicas da conversa
   âœ… Agente principal do contato
   âœ… HistÃ³rico completo de atribuiÃ§Ãµes
   âœ… Timeline com mensagens e atribuiÃ§Ãµes
   âœ… ANÃLISE AUTOMÃTICA de problemas
   âœ… RecomendaÃ§Ãµes de correÃ§Ã£o

================================================================================
  MÃ‰TODO 2: Queries SQL (MAIS RÃPIDO)
================================================================================

1. Abra o arquivo: debug-conversation-simple.sql
2. Na linha 10, altere:
   
   SET @conversation_id = [ID]; â† COLOQUE O ID AQUI
   
   Exemplo:
   SET @conversation_id = 123;

3. Execute as queries no MySQL/phpMyAdmin

================================================================================
  EXEMPLO DE SAÃDA
================================================================================

ğŸ” DEBUG DE CONVERSA - ID: 123
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Š HISTÃ“RICO DE ATRIBUIÃ‡Ã•ES
1. 14:24 - AtribuÃ­da para Gustavo (auto)
2. 14:25 - AtribuÃ­da para Gabriel (manual)
3. 14:28 - AtribuÃ­da para Gustavo (auto) âš ï¸ AUTO-ATRIBUIÃ‡ÃƒO!
4. 14:31 - AtribuÃ­da para Gustavo (auto) ğŸ”´ BUG: MESMO AGENTE!
5. 14:34 - AtribuÃ­da para Gustavo (auto) ğŸ”´ BUG: MESMO AGENTE!

ğŸ” ANÃLISE DE PROBLEMAS
ğŸ”´ REATRIBUIÃ‡Ã•ES DESNECESSÃRIAS: 8 atribuiÃ§Ãµes para o mesmo agente
ğŸ”´ AUTO-ATRIBUIÃ‡ÃƒO POR MENSAGEM: 8 atribuiÃ§Ãµes logo apÃ³s envio

ğŸ’¡ RECOMENDAÃ‡Ã•ES
1. Bug de auto-atribuiÃ§Ã£o (assigned_to vs agent_id) - JÃ CORRIGIDO

================================================================================
  O QUE FOI CORRIGIDO
================================================================================

âŒ ANTES (BUG):
   $assignedTo = $conversation['assigned_to'];  â† Campo nÃ£o existe!
   // Sempre null â†’ sempre reatribuÃ­a

âœ… DEPOIS (CORRIGIDO):
   $assignedTo = $conversation['agent_id'];  â† Campo correto!
   // SÃ³ reatribui se realmente nÃ£o tiver agente

Arquivo: app/Controllers/ConversationController.php (linha 1190)

================================================================================
  COMO CONFIRMAR QUE PROBLEMA FOI RESOLVIDO
================================================================================

1. Debug de conversa ANTIGA (antes da correÃ§Ã£o):
   php debug-conversation.php 123
   â†’ Deve mostrar: "ğŸ”´ REATRIBUIÃ‡Ã•ES DESNECESSÃRIAS"

2. Criar NOVA conversa (depois da correÃ§Ã£o):
   - Atribuir para um agente
   - Agente envia mensagem
   - Verificar se NÃƒO aparece reatribuiÃ§Ã£o

3. Debug da conversa NOVA:
   php debug-conversation.php [ID_NOVA]
   â†’ Deve mostrar: "âœ… Nenhum problema Ã³bvio detectado"

================================================================================
  ARQUIVOS CRIADOS
================================================================================

1. debug-conversation.php
   â†’ Script PHP completo com anÃ¡lise automÃ¡tica

2. debug-conversation-simple.sql
   â†’ Queries SQL para executar direto no MySQL

3. GUIA_DEBUG_CONVERSAS.md
   â†’ DocumentaÃ§Ã£o completa e detalhada

4. COMO_USAR_DEBUG.txt
   â†’ Este arquivo (guia rÃ¡pido)

================================================================================
  PRECISA DE AJUDA?
================================================================================

Consulte: GUIA_DEBUG_CONVERSAS.md
ContÃ©m:
- Passo a passo detalhado
- Exemplos de uso
- AnÃ¡lise de problemas comuns
- Queries SQL Ãºteis
- Como interpretar resultados

================================================================================
